var app=angular.module("app",["ngRoute","ui.bootstrap","restangular","pasvaz.bindonce"]);app.run(["$rootScope","$http","$location","$route",function(){}]),app.config(["$routeProvider",function(e){e.when("/orders",{templateUrl:"assets/partials/orders/index.html",controller:"OrdersCtrl",active:"home"}).when("/orders/edit",{templateUrl:"assets/partials/orders/entry-form.html",controller:"OrderEntryCtrl",active:"users"}).otherwise({redirectTo:"/orders"})}]),angular.module("app").controller("OrderEntryCtrl",["$scope","$location","api_connector",function(e,t,o){e.disableSubmit=!1,e.master={customer:{},driver:{},donation:{date:(new Date).setHours(0,0,0,0),dateActual:new Date,prescribed_weight:0,nonprescribed_weight:0,total_donation_weight:0}},e.addCollectionInformation=function(){e.disableSubmit=!0,o.sendCollectionDetails(e.form).then(function(){t.path("#/orders")})},e.updateTotalWeight=function(){e.form.donation.total_donation_weight=e.form.donation.prescribed_weight+e.form.donation.nonprescribed_weight};var n=t.search().key;n?o.getOrderByKey(n).then(function(t){e.form=angular.copy(t.data[n]),e.form._id=n,e.updateTotalWeight()}):e.form=angular.copy(e.master)}]),angular.module("app").controller("OrdersCtrl",["$scope","api_connector",function(e,t){e.orders=[{name:"blah1"},{name:"blah2"},{name:"blah3"}];var o=function(e){return Object.keys(e).map(function(t){var o=e[t];return o._id=t,console.log(o),o})};e.onDateChange=function(){},e.getOrders=function(n){var r=new Date(n.setHours(0,0,0,0)).getTime();t.getOrdersByDate(r).then(function(t){e.orders=o(t.data)})},e.getOrders(new Date)}]),angular.module("app").directive("order",[function(){return{restrict:"E",replace:!0,scope:{order:"="},templateUrl:"assets/partials/orders/order.html",link:function(){}}}]),angular.module("app").service("api_connector",["$http","$location",function(e,t){console.log(t.$$host);var o="localhost"==t.$$host?"http://localhost:8081/api/":"https://substation33.herokuapp.com/api/",n=function(t){return e({method:"GET",url:o+"collections/"+t})},r=function(t){return e({method:"GET",url:o+"collection/"+t})},a=function(t){return e({method:"POST",url:o+"collection"+(t._id?"?key="+t._id:""),headers:{"Content-Type":"application/json"},data:t})};return{getOrdersByDate:n,getOrderByKey:r,sendCollectionDetails:a}}]),angular.module("app").run(["$templateCache",function(e){e.put("assets/partials/index.html","Home"),e.put("assets/partials/orders/entry-form.html",'<div><p class="inline-block pb2 h2 mt1 light">Enter a new order</p><form><section><p class="h3 mt1">Customer</p><span class="h6 inline-block caps pt2 bold">Name:</span> <input type="text" ng-model="form.customer.name"> <span class="h6 inline-block caps pt2 bold">Address:</span> <input type="text" ng-model="form.customer.address"> <span class="h6 inline-block caps pt2 bold">email:</span> <input type="text" ng-model="form.customer.email"> <span class="h6 inline-block caps pt2 bold">Phone Number:</span> <input type="text" ng-model="form.customer.contact_number"></section><section class="pt2"><p class="h3">Driver</p></section><section class="pt3"><p class="h3">Donation Details</p><span class="h6 inline-block caps pt2 bold">Reason for donation:</span><br><p class="pt1"><input type="checkbox" ng-model="form.donation.social"> Social</p><p class="pt1"><input type="checkbox" ng-model="form.donation.environmental"> Environmental</p><span class="h6 inline-block caps pt2 mt2 bold">Prescribed:</span> <input type="number" ng-model="form.donation.prescribed_weight" ng-change="updateTotalWeight()"> <span class="h6 inline-block caps pt2 bold">Non-Prescribed:</span> <input type="number" ng-model="form.donation.nonprescribed_weight" ng-change="updateTotalWeight()"> <span class="h6 inline-block caps pt2 bold">Total:</span><div>{{ form.donation.total_donation_weight }}</div></section><section><span class="h6 inline-block caps pt2 bold">Collected?</span> <input type="checkbox" ng-model="form.donation.collected"></section></form><br><button ng-disabled="disableSubmit" class="clearfix right p1 h4 white bg-blue-hover rounded grow" ng-click="addCollectionInformation()">Submit</button><div class="clearfix"></div></div>'),e.put("assets/partials/orders/index.html",'<div><div class="absolute top--4-4 right-0"><div class="pt1"></div><a class="block grow rounded h4 p1 bg-white bg-dark-green-hover green white-hover text-decoration-none shadow" href="#/orders/edit">+ New</a></div><p class="h3 mt1">Orders</p><order ng-repeat="order in orders track by $index" order="order"></order></div>'),e.put("assets/partials/orders/order.html",'<div class="bg-dark-green bg-blue-hover grow-small white rounded p2 mt1"><a ng-href="#/orders/edit?key={{ order._id }}" class="text-decoration-none white">{{ order.customer.name }}</a></div>')}]);